<!doctype html><html lang=en dir=ltr><head><meta name=generator content="Hugo 0.83.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="excel 导出 #  $PHPExcel = new PHPExcel(); //实例化PHPExcel类，类似于在桌面上新建一个Excel表格 $PHPSheet = $PHPExcel->getActiveSheet(); //获得当前活动sheet的操作对象  $PHPSheet->setTitle('卡号'); //给当前活动sheet设置名称  $PHPSheet->setCellValue('A1','订单号') ->setCellValue('B1','手机号') ->setCellValue('C1','是否靓号') ->setCellValue('D1','是否虚拟号') ->setCellValue('E1','卡号等级'); $order = D('order')->select(); foreach ($order as $key => $val){ } $PHPSheet->setCellValue('A2','张三')->setCellValue('B2','50'); //给当前活动sheet填充数据，数据填充是按顺序一行一行填充的，假如想给A1留空，可以直接setCellValue(‘A1’,’’); //$PHPSheet->setCellValue('A2','张三')->setCellValue('B2','50');  $PHPWriter = PHPExcel_IOFactory::createWriter($PHPExcel,'Excel2007');//按照指定格式生成Excel文件，‘Excel2007’表示生成2007版本的xlsx，‘Excel5’表示生成2003版本Excel文件  header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');//告诉浏览器输出07Excel文件 //header('Content-Type:application/vnd.ms-excel');//告诉浏览器将要输出Excel03版本文件 header('Content-Disposition: attachment;filename=&#34;card_import_template.xlsx&#34;');//告诉浏览器输出浏览器名称 header('Cache-Control: max-age=0');//禁止缓存 $PHPWriter->save(&#34;php://output&#34;); "><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="excel 导出 #  $PHPExcel = new PHPExcel(); //实例化PHPExcel类，类似于在桌面上新建一个Excel表格 $PHPSheet = $PHPExcel->getActiveSheet(); //获得当前活动sheet的操作对象  $PHPSheet->setTitle('卡号'); //给当前活动sheet设置名称  $PHPSheet->setCellValue('A1','订单号') ->setCellValue('B1','手机号') ->setCellValue('C1','是否靓号') ->setCellValue('D1','是否虚拟号') ->setCellValue('E1','卡号等级'); $order = D('order')->select(); foreach ($order as $key => $val){ } $PHPSheet->setCellValue('A2','张三')->setCellValue('B2','50'); //给当前活动sheet填充数据，数据填充是按顺序一行一行填充的，假如想给A1留空，可以直接setCellValue(‘A1’,’’); //$PHPSheet->setCellValue('A2','张三')->setCellValue('B2','50');  $PHPWriter = PHPExcel_IOFactory::createWriter($PHPExcel,'Excel2007');//按照指定格式生成Excel文件，‘Excel2007’表示生成2007版本的xlsx，‘Excel5’表示生成2003版本Excel文件  header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');//告诉浏览器输出07Excel文件 //header('Content-Type:application/vnd.ms-excel');//告诉浏览器将要输出Excel03版本文件 header('Content-Disposition: attachment;filename=&#34;card_import_template.xlsx&#34;');//告诉浏览器输出浏览器名称 header('Cache-Control: max-age=0');//禁止缓存 $PHPWriter->save(&#34;php://output&#34;); "><meta property="og:type" content="article"><meta property="og:url" content="https://kangkang17.cn/wiki/PHP/function/excel-export/"><meta property="article:section" content="wiki"><meta property="article:modified_time" content="2021-05-28T12:49:18+08:00"><title>Excel Export | sun17 wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.1639cc58b39d753e5ce211e45ca1950799431f352ff7bd1baadfa7fcedfe8043.css integrity="sha256-FjnMWLOddT5c4hHkXKGVB5lDHzUv970bqt+n/O3+gEM="><script defer src=/en.search.min.bc9d786cb1e040ca4330646db9f7ea38d6044e39e5a1d7c2d5d9a3a6c6dcb5b0.js integrity="sha256-vJ14bLHgQMpDMGRtuffqONYETjnlodfC1dmjpsbctbA="></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk="></script><link rel=apple-touch-icon sizes=128x128 href=128x128.jpg><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="https://hm.baidu.com/hm.js?65e05e8c0631a0d2802629f8ceb31fee",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b),console.log("欢迎加入，https://airdb.dev"),console.log("Welcome，https://airdb.dev")})()</script><nav class="app-nav pc no-badge"><div class=logo><a href=//airdb.dev/ target=__blank class=dcloud-logo></a><a href=./ class="uniapp-logo active"></a></div><div class="search nav-search"><div class=input-wrap><input type=search id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class=clear-button><svg width="26" height="24"><circle cx="12" cy="12" r="11" fill="#ccc"/><path stroke="#fff" stroke-width="2" d="M8.25 8.25l7.5 7.5"/><path stroke="#fff" stroke-width="2" d="M8.25 15.75l7.5-7.5"/></svg></div></div><div class=results-panel></div></div><ul class=nav-url><li><a href=https://airdb.dev/hugo-book/>主题首页</a></li><li><a href=https://gohugo.io/getting-started/configuration>Hugo 配置</a></li><li><a href=https://github.com/airdb-wiki/hugo-book/actions>组件</a></li><li><a href=https://github.com/airdb-wiki/hugo-book/actions>APIs</a></li><li><a href=https://github.com/airdb-wiki/hugo-book/actions>Github Action</a></li></ul><ul class=nav-href><li class=ext-link><a href=https://themes.gohugo.io/hugo-book/ target=__blank>插件市场</a></li><li class=ext-link><a href=https://github.com/airdb-wiki/hugo-book/discussions target=__blank>讨论区</a></li><li><a href=//github.com/sponsors/airdb target=__blank style=color:#f60!important><img src=https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/45e691f0-4f3d-11eb-b680-7980c8a877b8.png class=heart>赞助我们</a></li></ul><div class=github><a href=//github.com/airdb-wiki/hugo-book target=_blank><img src=https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/44f8d690-4f3d-11eb-b680-7980c8a877b8.svg></a></div></nav></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><ul><li><p><strong>语言</strong></p></li><li><p><a href=/wiki/go/>Golang</a></p><ul><li><a href=/wiki/go/go-laravel/>go-laravel</a></li><li><a href=/wiki/go/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/>垃圾回收</a></li><li><a href=/wiki/go/Go%E5%B9%B6%E5%8F%91%E5%8E%9F%E7%90%86%E5%8F%8AGPM%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5/>Go并发原理及GPM调度策略</a></li></ul></li><li><p><a href=/wiki/Python/>Python</a></p><ul><li><a href=/wiki/Python/selenium/>selenium</a></li><li><a href=/wiki/Python/uswgi%E4%B8%8Enginx/>uswgi与nginx</a></li><li><a href=/wiki/Python/%E6%95%B0%E6%8D%AE%E9%9B%86/>数据集</a></li><li><a href=/wiki/Python/common-function/>COMMON函数</a></li><li><a href=/wiki/Python/threading/>threading</a></li><li><a href=/wiki/Python/queue/>queue</a></li><li><a href=/wiki/Python/tf-idf/>tf-idf 文本分类</a></li></ul></li><li><p><a href=/wiki/PHP/>PHP</a></p><ul><li><a href=/wiki/PHP/fpm%E4%BC%98%E5%8C%96/>fpm优化</a></li><li><a href=/wiki/PHP/function/excel-export/ class=active>excel导出</a></li><li><a href=/wiki/PHP/function/%E5%AF%B9%E8%B1%A1%E4%B8%8E%E6%95%B0%E7%BB%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/>对象与数组相互转换</a></li></ul></li><li><p><a href=/wiki/VUE/>VUE</a></p><ul><li><a href=/wiki/VUE/iView%E6%A1%88%E4%BE%8B/>iView案例</a><br></li></ul></li><li><p><strong>数据库</strong></p></li><li><p><a href=/wiki/MySql/>MySql</a></p><ul><li><a href=/wiki/MySql/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/>事务隔离级别</a></li><li><a href=/wiki/MySql/mysql%E5%BC%82%E6%AD%A5%E5%A4%8D%E5%88%B6/>mysql异步复制</a></li><li><a href=/wiki/MySql/%E5%88%9B%E5%BB%BA%E5%87%BD%E6%95%B0/>创建函数</a></li><li><a href=/wiki/MySql/%E5%BF%98%E8%AE%B0%E5%AF%86%E7%A0%81/>忘记密码</a></li><li><a href=/wiki/MySql/%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E5%B9%B6%E6%8E%88%E6%9D%83/>创建用户并授权</a></li><li><a href=/wiki/MySql/%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/>常见函数</a></li></ul></li><li><p><a href=/wiki/Redis/>Redis</a></p><ul><li><a href=/wiki/Redis/%E5%BC%82%E6%AD%A5%E5%A4%8D%E5%88%B6/>异步复制</a></li></ul></li><li><p><a href=/wiki/Mango/>Mango</a><br></p></li><li><p><strong>WebServer</strong></p></li><li><p><a href=/wiki/Nginx/>Nginx</a></p><ul><li><a href=/wiki/Nginx/%E7%A6%81%E7%BD%91%E6%AE%B5/>禁网段</a><br></li></ul></li><li><p><strong>Linux</strong></p><ul><li><a href=/wiki/Linux/CentOS%E6%90%AD%E5%BB%BAShadowsocks%E6%9C%8D%E5%8A%A1%E7%AB%AF/>CentOS搭建Shadowsocks服务端</a></li><li><a href=/wiki/Linux/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>常用命令</a></li></ul></li><li><p><strong>docker</strong></p><ul><li><a href=/wiki/Docker/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>常用命令</a></li></ul></li><li><p><strong>微服务</strong></p><ul><li><a href=/wiki/%E5%BE%AE%E6%9C%8D%E5%8A%A1/consul/>consul</a></li></ul></li><li><p><strong>领域驱动设计</strong></p><ul><li><a href=/wiki/DDD/%E7%A4%BA%E4%BE%8B/>示例</a></li><li><a href=/wiki/DDD/domain/>domain</a></li><li><a href=/wiki/DDD/PO-DO-VO-DTO/>PO-DO-VO-DTO</a></li><li><a href=/wiki/DDD/%E6%AD%A5%E9%AA%A4/>步骤</a></li></ul></li></ul><div class=contact-item><div class=contact-smg><div>扫码添加企业微信</div><img src=https://airdb.dev/hugo-book/qrcode.png width=90 height=90></div></div></nav><script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Excel Export</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#excel-导出>excel 导出</a></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=excel-导出>excel 导出
<a class=anchor href=#excel-%e5%af%bc%e5%87%ba>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$PHPExcel       <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PHPExcel</span>(); <span style=color:#75715e>//实例化PHPExcel类，类似于在桌面上新建一个Excel表格
</span><span style=color:#75715e></span>$PHPSheet       <span style=color:#f92672>=</span> $PHPExcel<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getActiveSheet</span>(); <span style=color:#75715e>//获得当前活动sheet的操作对象
</span><span style=color:#75715e></span>
$PHPSheet<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setTitle</span>(<span style=color:#e6db74>&#39;卡号&#39;</span>); <span style=color:#75715e>//给当前活动sheet设置名称
</span><span style=color:#75715e></span>
$PHPSheet<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;A1&#39;</span>,<span style=color:#e6db74>&#39;订单号&#39;</span>)
<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;B1&#39;</span>,<span style=color:#e6db74>&#39;手机号&#39;</span>)
<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;C1&#39;</span>,<span style=color:#e6db74>&#39;是否靓号&#39;</span>)
<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;D1&#39;</span>,<span style=color:#e6db74>&#39;是否虚拟号&#39;</span>)
<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;E1&#39;</span>,<span style=color:#e6db74>&#39;卡号等级&#39;</span>);


$order  <span style=color:#f92672>=</span>   <span style=color:#a6e22e>D</span>(<span style=color:#e6db74>&#39;order&#39;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>select</span>();
<span style=color:#66d9ef>foreach</span> ($order <span style=color:#66d9ef>as</span> $key <span style=color:#f92672>=&gt;</span> $val){

}

$PHPSheet<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;A2&#39;</span>,<span style=color:#e6db74>&#39;张三&#39;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setCellValue</span>(<span style=color:#e6db74>&#39;B2&#39;</span>,<span style=color:#e6db74>&#39;50&#39;</span>);
<span style=color:#75715e>//给当前活动sheet填充数据，数据填充是按顺序一行一行填充的，假如想给A1留空，可以直接setCellValue(‘A1’,’’);
</span><span style=color:#75715e>//$PHPSheet-&gt;setCellValue(&#39;A2&#39;,&#39;张三&#39;)-&gt;setCellValue(&#39;B2&#39;,&#39;50&#39;);
</span><span style=color:#75715e></span>
$PHPWriter <span style=color:#f92672>=</span> <span style=color:#a6e22e>PHPExcel_IOFactory</span><span style=color:#f92672>::</span><span style=color:#a6e22e>createWriter</span>($PHPExcel,<span style=color:#e6db74>&#39;Excel2007&#39;</span>);<span style=color:#75715e>//按照指定格式生成Excel文件，‘Excel2007’表示生成2007版本的xlsx，‘Excel5’表示生成2003版本Excel文件
</span><span style=color:#75715e></span>
<span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span>);<span style=color:#75715e>//告诉浏览器输出07Excel文件
</span><span style=color:#75715e>//header(&#39;Content-Type:application/vnd.ms-excel&#39;);//告诉浏览器将要输出Excel03版本文件
</span><span style=color:#75715e></span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;Content-Disposition: attachment;filename=&#34;card_import_template.xlsx&#34;&#39;</span>);<span style=color:#75715e>//告诉浏览器输出浏览器名称
</span><span style=color:#75715e></span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;Cache-Control: max-age=0&#39;</span>);<span style=color:#75715e>//禁止缓存
</span><span style=color:#75715e></span>$PHPWriter<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>save</span>(<span style=color:#e6db74>&#34;php://output&#34;</span>);
</code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/sun17ya/sun17ya.github.io/commit/e32ab07cf0e457b9f68c14c71c1c0090480bca1a title="Last modified by sk532359025 | Fri May 28 04:49:18 UTC 2021" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Fri May 28 04:49:18 UTC 2021</span></a></div><div><a class="flex align-center" href=https://github.com/sun17ya/sun17ya.github.io/edit/main/exampleSite/content/wiki/PHP/function/excel-export.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#excel-导出>excel 导出</a></li></ul></li></ul></nav></div></aside></main></body></html>